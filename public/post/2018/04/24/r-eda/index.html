<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>使用R进行探索性数据分析 | Record life to a data scientist</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">使用R进行探索性数据分析</span></h1>
<h2 class="author">王诗翔</h2>
<h2 class="date">2018/04/24</h2>
<p class="terms">
  
  
  Categories: <a href="/categories/r">R</a> <a href="/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90">数据分析</a> 
  
  
  
  Tags: <a href="/tags/notebook">notebook</a> <a href="/tags/dplyr">dplyr</a> <a href="/tags/ggplot">ggplot</a> 
  
  
</p>
</div>

<main>
<div id="TOC">
<ul>
<li><a>准备</a></li>
<li><a>可视化分布</a></li>
<li><a>典型值</a></li>
</ul>
</div>

<p>该部分学习内容来自《R for Data Science》。</p>
<p>这次我们学习可视化与处理数据来系统地探索数据——统计学家称之为<strong>探索性数据分析</strong>（exploratory data analysis），简称为EDA。</p>
<p>EDA是一个迭代的圆圈：</p>
<ol type="1">
<li>生成关于你所拥有数据的问题</li>
<li>通过对数据可视化、转换和建模寻找答案</li>
<li>使用你学到的重定义你的问题或者生成新的问题</li>
</ol>
<p>相比于严格的规则与流程，EDA更像一种思考状态。在EDA的初始阶段，你可以随意探索跳入你脑海的任意一个想法。</p>
<p><strong>数据清理</strong>仅仅是EDA的一个应用，你询问是否你的数据如你所期。想要进行数据清理，你将需要使用EDA所有的工具：可视化、转换与建模。</p>
<section class="level2">
<h2>准备</h2>
<p>这部分我们将使用<strong>dplyr</strong>与<strong>ggplot2</strong>交互地对数据提问并回答，请确保在学习前安装好<code>tidyverse</code>包，可以顺利进行以下操作：</p>
<pre class="r"><code>library(tidyverse)
## -- Attaching packages -------------------------------------------------------------------- tidyverse 1.2.1 --
## &lt;U+221A&gt; ggplot2 2.2.1     &lt;U+221A&gt; purrr   0.2.4
## &lt;U+221A&gt; tibble  1.4.1     &lt;U+221A&gt; dplyr   0.7.4
## &lt;U+221A&gt; tidyr   0.8.0     &lt;U+221A&gt; stringr 1.2.0
## &lt;U+221A&gt; readr   1.1.1     &lt;U+221A&gt; forcats 0.2.0
## Warning: 绋嬭緫鍖�&#39;tidyr&#39;鏄敤R鐗堟湰3.4.4 鏉ュ缓閫犵殑
## -- Conflicts ----------------------------------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<p>EDA的目标是理解数据，最容易实现的方式是用问题作为用具引导我们进行探索。想要提出<strong>有质量</strong>的问题首先必须提出<strong>大量</strong>问题。</p>
<p>提问的方式没有准则可言，但两类基本问题的提出会对我们理解数据大有裨益：</p>
<ol type="1">
<li>在我的变量中有什么类型的变异？</li>
<li>在我的变量之间有什么共同的变异？</li>
</ol>
<p>在正式进行分析之前，允许我定义一些术语：</p>
<ul>
<li>一个<strong>变量</strong>是一个你可以测量的数量、质量或者属性</li>
<li>一个<strong>值</strong>是当你测量一个变量时它的状态</li>
<li>一个<strong>观测</strong>或者一个<strong>案例</strong>是相似条件下一组测量值的集合。一次观测通常包含多个值，每个值与不同的变量相关联。我将有时称一个观测为一个数据点</li>
<li><strong>表格数据</strong>是值的集合，每一个值都与一个变量和一个观测相关联</li>
</ul>
</section>
<section class="level2">
<h2>可视化分布</h2>
<p>你如何可视化一个变量的分布取决于该变量是连续还是分类的。如果一个变量仅能取少量的几个值，我们就说它是<strong>分类变量</strong>。在R中，分类变量常保存为因子或者是字符向量。想要检查分类变量的分布，使用直方图：</p>
<pre class="r"><code>ggplot(data = diamonds) + 
    geom_bar(mapping = aes(x = cut))</code></pre>
<p><img src="/post/2018/2018-04-24-R-EDA_files/figure-html/unnamed-chunk-1-1.svg" width="576" /></p>
<p>直方图的高度显示了每一个<code>x</code>值有多少个观测。你可以使用<code>dplyr::count()</code>手动进行计算：</p>
<pre class="r"><code>diamonds %&gt;%
    count(cut)
## # A tibble: 5 x 2
##   cut           n
##   &lt;ord&gt;     &lt;int&gt;
## 1 Fair       1610
## 2 Good       4906
## 3 Very Good 12082
## 4 Premium   13791
## 5 Ideal     21551</code></pre>
<p>或者</p>
<pre class="r"><code>diamonds %&gt;% 
    group_by(cut) %&gt;% 
    summarise(n = n())
## # A tibble: 5 x 2
##   cut           n
##   &lt;ord&gt;     &lt;int&gt;
## 1 Fair       1610
## 2 Good       4906
## 3 Very Good 12082
## 4 Premium   13791
## 5 Ideal     21551</code></pre>
<p>想要检查连续变量的分布，使用直方图：</p>
<pre class="r"><code>ggplot(data = diamonds) + 
    geom_histogram(mapping = aes(x=carat), binwidth = 0.5)</code></pre>
<p><img src="/post/2018/2018-04-24-R-EDA_files/figure-html/unnamed-chunk-4-1.svg" width="576" /></p>
<p>你也可以结合<code>dplyr::count()</code>与<code>ggplot2::cut_width()</code>手动计算这个：</p>
<pre class="r"><code>diamonds %&gt;% 
    count(cut_width(carat, 0.5))
## # A tibble: 11 x 2
##    `cut_width(carat, 0.5)`     n
##    &lt;fct&gt;                   &lt;int&gt;
##  1 [-0.25,0.25]              785
##  2 (0.25,0.75]             29498
##  3 (0.75,1.25]             15977
##  4 (1.25,1.75]              5313
##  5 (1.75,2.25]              2002
##  6 (2.25,2.75]               322
##  7 (2.75,3.25]                32
##  8 (3.25,3.75]                 5
##  9 (3.75,4.25]                 4
## 10 (4.25,4.75]                 1
## 11 (4.75,5.25]                 1</code></pre>
<p>直方图将x轴划分为相等的宽度（由bin控制），然后使用每个条形的高度来代表落入该区域观测的数目。条形的宽度非常重要，不同的设定可能揭示出数据的内在分布模式。</p>
<pre class="r"><code>smaller &lt;- diamonds %&gt;% 
    filter(carat &lt; 3)

ggplot(data = smaller, mapping = aes(x = carat)) + geom_histogram(binwidth = 0.1)</code></pre>
<p><img src="/post/2018/2018-04-24-R-EDA_files/figure-html/unnamed-chunk-6-1.svg" width="576" /></p>
<p>如果你想要在同一幅图上画多个直方图，我推荐你使用<code>geom_freqpoly()</code>函数而不是<code>geom_histogram()</code>，它们的内部计算一致，但前者使用线形。</p>
<pre class="r"><code>ggplot(data = smaller, mapping = aes(x = carat, color = cut)) +
    geom_freqpoly(binwidth = 0.1)</code></pre>
<p><img src="/post/2018/2018-04-24-R-EDA_files/figure-html/unnamed-chunk-7-1.svg" width="576" /></p>
</section>
<section class="level2">
<h2>典型值</h2>
<p>在条形图和直方图中，高的条形显示了变量通常出现的值，而短的条形说明比较少见，而没有条形出现的地方说明变量几乎不可能会出现那个值。想要把这些信息转为有用的问题，寻找不同寻常之处：</p>
<ul>
<li>哪个值最常出现？为什么?</li>
<li>哪个值很少出现？为什么？这符合你的预期吗?</li>
<li>你可以看到任何异常的模式吗?什么可以解释它？</li>
</ul>
<p>作为一个示例，下面的直方图表明一些有趣的问题：</p>
<ul>
<li>为什么</li>
</ul>
</section>

</main>

  <footer>
  <script src="//yihui.name/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-108892843-2', 'auto');
ga('send', 'pageview');
</script>

<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "codelife" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

<script>
hljs.configure({languages: []});
hljs.initHighlightingOnLoad();
</script>

<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "d135f460-3fc5-4802-8169-bd08e4734a09", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>

<script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=51zdev6aq4a&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async"></script>
  
  <hr/>
  &copy; <a href="https://www.shixiangwang.top">Shixiang Wang</a> 2018 &ndash; 2018 保留所有版权 | <a href="https://github.com/ShixiangWang">Github</a> | <a href="https://twitter.com/ShixiangWang">Twitter</a> | <a href="https://www.jianshu.com/u/b6608e27dc74">简书</a>
  
  </footer>
  </body>
</html>

